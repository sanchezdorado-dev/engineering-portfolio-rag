---
import type { CollectionEntry } from 'astro:content';

type Props = CollectionEntry<'trajectory'>['data'];

const { type, period, institution, role, description, skills } = Astro.props;

const isExperience = type === 'experience';
---

<article class="group relative pl-8 pb-10 last:pb-0">
  <div class="absolute left-0 top-1 w-3 h-3 rounded-full border-2 border-blue-500 bg-white dark:bg-gray-900"></div>
  <div class="absolute left-[5px] top-4 bottom-0 w-px bg-gray-300 dark:bg-gray-600 group-last:hidden"></div>

  <div class="bg-white dark:bg-gray-800 rounded-2xl p-5 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow duration-200">
    <div class="flex flex-wrap items-start justify-between gap-3 mb-3">
      <div>
        <h3 class="text-sm font-bold text-gray-900 dark:text-white leading-tight mb-1">
          {institution}
        </h3>
        <p class="text-[13px] text-blue-600 dark:text-blue-400 font-medium">{role}</p>
      </div>
      <div class="flex flex-col items-end gap-1.5 shrink-0">
        <span class="text-[11px] text-gray-500 dark:text-gray-400 font-medium">{period}</span>
        <span class={`text-[10px] font-semibold px-2 py-0.5 rounded-full ${isExperience ? 'bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300' : 'bg-purple-100 dark:bg-purple-900/40 text-purple-700 dark:text-purple-300'}`}>
          {isExperience ? 'Experiencia' : 'Educación'}
        </span>
      </div>
    </div>

    {description && description.length > 0 && (
      <ul class="space-y-1.5 mb-4">
        {description.map((line) => (
          <li class="text-[12px] text-gray-600 dark:text-gray-300 leading-relaxed flex gap-2">
            <span class="text-blue-400 shrink-0 mt-0.5">›</span>
            <span>{line}</span>
          </li>
        ))}
      </ul>
    )}

    {skills && skills.length > 0 && (
      <div class="flex flex-wrap gap-1.5">
        {skills.map((skill) => (
          <span class="text-[11px] font-medium px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md">
            {skill}
          </span>
        ))}
      </div>
    )}
  </div>
</article>